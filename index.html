<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>หน้าแรก</title>
    <style>
        /* ------------------------------------- */
        /* ส่วนที่ 0: LOADING SCREEN */
        /* ------------------------------------- */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #818889; /* สีพื้นหลังตามที่ต้องการ */
            z-index: 9999; /* ให้ Loading Screen อยู่ด้านบนสุด */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease-out; /* เพิ่ม Fade out effect */
            opacity: 1;
        }

        #loading-screen.hidden {
            opacity: 0;
            pointer-events: none; /* ปิดการโต้ตอบเมื่อซ่อนแล้ว */
        }
        
        /* Animation สำหรับรูป Reaper (loading1.png) */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        #loading-reaper {
            width: 150px; /* ปรับขนาดตามความเหมาะสม */
            height: auto;
            margin-bottom: 20px;
            animation: float 2s ease-in-out infinite; /* ลอยขึ้นลงเบาๆ */
        }

        #loading-text {
            width: 200px; /* ปรับขนาดตามความเหมาะสม */
            height: auto;
        }

        /* ------------------------------------- */
        /* ส่วนที่ 1: การตั้งค่าพื้นฐานและพื้นหลัง (Video) */
        /* ------------------------------------- */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Trajan Pro', Georgia, serif; 
            color: #333;
            text-align: center;
            padding-bottom: 50px;
            visibility: hidden; 
        }

        body.loaded {
            visibility: visible;
        }

        /* ------------------------------------- */
        /* CSS สำหรับ Video Background */
        /* ------------------------------------- */
        #video-background {
            position: fixed; 
            right: 0;
            bottom: 0;
            min-width: 100%; 
            min-height: 100%;
            width: auto;
            height: auto;
            z-index: -100;
            overflow: hidden;
            background-size: cover;
        }
        
        /* ------------------------------------- */
        /* Overlay เพื่อให้ข้อความอ่านง่ายขึ้น (แนะนำให้ใช้) */
        /* ------------------------------------- */
        .content-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: -99;
        }

        /* จัดเนื้อหาหลักให้อยู่ตรงกลางของพื้นที่ */
        .content-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #ffffff; 
        }
        
        /* ------------------------------------- */
        /* ส่วนที่ 2: รูปภาพและส่วนกลางหน้าจอ */
        /* ------------------------------------- */
        .center-image {
            display: block;
            margin: 10px auto; 
            max-width: 90%;
            height: auto;
        }

        /* ------------------------------------- */
        /* ส่วนที่ 3: นับถอยหลัง (Countdown) - Default (Desktop) */
        /* ------------------------------------- */
        #countdown {
            font-size: 5.25em; 
            font-weight: bold;
            color: #d7c1a0; 
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); 
            margin: 5px 0; 
            padding: 15px 0; 
            display: inline-block; 
        }

        /* ------------------------------------- */
        /* ส่วนที่ 4: การ์ด/ใส่ชื่อ (Card Generator) - Default (Desktop) */
        /* ------------------------------------- */
        .card-generator-section {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 30px;
            margin: 40px auto;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            color: #333; 
        }
        
        /* ช่องกรอกชื่อและปุ่ม */
        #nameInput, #submitName, #saveImage {
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            width: 70%;
            box-sizing: border-box; 
        }
        #submitName, #saveImage {
             width: auto;
        }

        /* ส่วนแสดงรูปภาพ card.jpg (Canvas) - Default (Desktop) */
        #card-container {
            margin: 30px auto 10px;
            width: 600px; 
            height: 600px; 
            overflow: hidden;
            position: relative;
        }

        /* Canvas สำหรับวาดรูปภาพและข้อความ */
        #cardCanvas {
            width: 100%;
            height: 100%;
            display: block;
            border: 1px solid #ccc; 
        }

        /* ------------------------------------- */
        /* ส่วนที่ 5: รูปภาพ Cover (Responsive Grid) */
        /* ------------------------------------- */
        .covers-container {
            display: flex;
            justify-content: center;
            gap: 15px; 
            margin: 40px auto;
            padding: 0 10px;
            max-width: 95%;
        }

        .cover-item {
            flex: 1; 
            min-width: 100px;
            max-width: 300px; 
            height: auto;
            transition: transform 0.3s ease; 
            border-radius: 8px;
            overflow: hidden;
        }

        .cover-item:hover {
            transform: scale(1.05);
        }

        .cover-item img {
            display: block;
            width: 100%;
            height: auto;
            border-radius: 5px;
        }

        /* ===================================== */
        /* MEDIA QUERIES (สำหรับ Mobile และ Tablet) */
        /* ===================================== */

        @media (max-width: 768px) {
            #countdown {
                font-size: 3.5em; 
            }
            .card-generator-section {
                 max-width: 90%; 
            }
            #card-container {
                width: 90%;
                height: 0;
                padding-bottom: 90%;
                position: relative;
                margin-left: auto;
                margin-right: auto;
            }
            #cardCanvas {
                position: absolute;
                top: 0;
                left: 0;
            }
            .covers-container {
                gap: 10px;
                padding: 0 5px;
            }
        }
        
        @media (max-width: 480px) {
            #countdown {
                font-size: 2.5em;
            }
            .card-generator-section {
                 padding: 20px;
            }
            .covers-container {
                flex-direction: column; 
                align-items: center;
                gap: 15px;
            }
            .cover-item {
                max-width: 85%;
            }
            #nameInput {
                width: 100%;
            }
            #submitName, #saveImage {
                 display: block; 
                 width: 100%;
                 margin: 10px 0;
            }
        }
        
        @media (min-aspect-ratio: 16/9) {
            #video-background {
                width: 100%;
                height: auto;
            }
        }
        @media (max-aspect-ratio: 16/9) {
            #video-background {
                width: auto;
                height: 100%;
            }
        }
    </style>
</head>
<body>

    <div id="loading-screen">
        <img src="loading1.png" alt="Loading Reaper" id="loading-reaper">
        <img src="loading2.png" alt="Loading Text" id="loading-text">
    </div>
    
    <audio id="bg-music" loop muted>
        <source src="halloween.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <video muted loop id="video-background">
        <source src="BG.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    
    <div class="content-overlay"></div>

    <div class="content-container">

        <img src="text01.png" alt="ข้อความที่ 1" class="center-image">
        <img src="line2.png" class="center-image" style="max-width: 300px; margin-bottom: 0px;">
        
        <div id="countdown">
            00 : 00 : 00
        </div>
        
        <img src="line3.png" class="center-image" style="max-width: 300px; margin-top: 0px;">
        

        <div class="card-generator-section">
            <img src="text02.png" class="center-image" style="max-width: 600px;">
            <input type="text" id="nameInput" placeholder="ใส่ชื่อของคุณที่นี่">
            <button id="submitName">พร้อมตกนรก</button>

            <div id="card-container">
                <canvas id="cardCanvas" width="1200" height="1200"></canvas>
            </div>

            <button id="saveImage" disabled>💾 บันทึกรูปภาพ</button>
            <p style="font-size: 0.8em; color: #555;">(รูปภาพที่แสดงในกรอบลดขนาดลง 50% เพื่อให้แสดงผลบนหน้าจอ)</p>
        </div>

        <img src="text03.png" alt="ข้อความที่ 3" class="center-image">

        <div class="covers-container">
            <a href="https://SugarBrown.readawrite.com" target="_blank" class="cover-item">
                <img src="cover1.png" alt="Cover 1">
            </a>
            <a href="https://takerukung.readawrite.com" target="_blank" class="cover-item">
                <img src="cover2.png" alt="Cover 2">
            </a>
            <a href="https://Kajornpruek19.readawrite.com" target="_blank" class="cover-item">
                <img src="cover3.png" alt="Cover 3">
            </a>
        </div>

    </div>

    <script>
        /* ------------------------------------- */
        /* ส่วนที่ 6: JavaScript (นับถอยหลัง) */
        /* ------------------------------------- */

        function startCountdown() {
            const targetDate = new Date('October 31, 2025 00:00:00 GMT+07:00').getTime();
            const countdownEl = document.getElementById('countdown');

            const interval = setInterval(function() {
                const now = new Date().getTime();
                const distance = targetDate - now;

                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                const seconds = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');

                if (distance > 0) {
                    const totalHours = days * 24 + parseInt(hours);
                    countdownEl.innerHTML = `${totalHours.toString().padStart(2, '0')} : ${minutes} : ${seconds}`;
                } else {
                    clearInterval(interval);
                    countdownEl.innerHTML = "สิ้นสุดการนับถอยหลัง";
                }
            }, 1000);
        }

        /* ------------------------------------- */
        /* ส่วนที่ 7: JavaScript (สร้างการ์ด) */
        /* ------------------------------------- */

        const canvas = document.getElementById('cardCanvas');
        const ctx = canvas.getContext('2d');
        const submitBtn = document.getElementById('submitName');
        const saveBtn = document.getElementById('saveImage');
        const nameInput = document.getElementById('nameInput');
        const bgMusic = document.getElementById('bg-music');

        const randomTexts = [
            "ถูกถมในกองนิยายเกย์",
            "เสี้ยนตำนิ้ว",
            "สำลักชานม",
            "แย่งพระเอกกับขจรพฤกษ์",
            "SugarBrownลืมอัพตอน",
            "หลงTakerukung",
            "เลือดกำเดาทะลัก",
            "กรี๊ดจนลืมหายใจ",
            "เล็บขบ",
            "แมวกัดตูด",
            "หัวเราะแรงไป",
            "ไถtiktokนิ้วล๊อค",
            "สำลักหมาล่า",
            "ข้าวเหนียวติดฟัน",
            "ไม่สระผม",
            "ไม่ได้เติมเกย์",
            "ขี้เกียจหายใจ"
        ];
        
        const cardImage = new Image();
        cardImage.crossOrigin = "Anonymous";
        cardImage.src = 'card.jpg';
        
        let isCardLoaded = false;
        
        cardImage.onload = function() {
            isCardLoaded = true;
            drawCard(''); 
            saveBtn.disabled = false; 
            canvas.style.border = 'none'; 
        };

        cardImage.onerror = function() {
            ctx.fillStyle = 'red';
            ctx.font = '30pt Arial';
            ctx.textAlign = 'center';
            ctx.fillText('ไม่พบไฟล์ card.jpg', 600, 600);
            saveBtn.disabled = true;
            console.error("Error loading card.jpg. Please check the file path.");
        };
        
        function drawCard(userName, randomText = null) {
            if (!isCardLoaded) {
                 cardImage.onload = () => drawCard(userName, randomText);
                 return;
            }
            
            ctx.drawImage(cardImage, 0, 0, 1200, 1200);

            if (userName) {
                ctx.fillStyle = 'white'; 
                ctx.font = 'bold 40pt "Trajan Pro", Arial'; 
                ctx.textAlign = 'center';
                
                const nameX = 600;
                const nameY = 510;
                
                ctx.fillText(userName, nameX, nameY);
            }

            if (randomText) {
                const textX = 600;
                const textY = 800;
                
                ctx.fillText(randomText, textX, textY);
            }
        }

        submitBtn.addEventListener('click', function() {
            const userName = nameInput.value.trim();
            const randomText = randomTexts[Math.floor(Math.random() * randomTexts.length)];
            
            drawCard(userName || 'ชื่อของคุณ', randomText);
        });
        
        saveBtn.addEventListener('click', function() {
            if (!isCardLoaded) return; 
            
            const dataURL = canvas.toDataURL('image/png');
            
            const a = document.createElement('a');
            a.href = dataURL;
            a.download = 'Card_Prediction.png';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });

        /* ------------------------------------- */
        /* ส่วนที่ 8: JavaScript (จัดการ Loading & Audio) */
        /* ------------------------------------- */
        
        // ฟังก์ชันซ่อน Loading Screen
        function hideLoadingScreen() {
             const loadingScreen = document.getElementById('loading-screen');
             const body = document.body;
             
             // 1. ลองเริ่มเล่นเพลง (ต้องเปิดเสียงก่อน)
             bgMusic.muted = false;
             const playPromise = bgMusic.play();
             
             // จัดการ Promise เพื่อดักจับข้อผิดพลาด (เช่น เบราว์เซอร์บล็อกการเล่นอัตโนมัติ)
             if (playPromise !== undefined) {
                 playPromise.then(() => {
                     console.log("Audio playback started successfully.");
                 }).catch(error => {
                     // หากเบราว์เซอร์บล็อกการเล่นอัตโนมัติ 
                     console.warn("Audio Autoplay was blocked. User interaction is required to play sound.", error);
                     // อาจจะต้องเพิ่มปุ่ม "Click to Start" บนหน้าจอหลัก
                 });
             }
             
             // 2. ซ่อน Loading Screen
             loadingScreen.classList.add('hidden');
             
             setTimeout(() => {
                 loadingScreen.style.display = 'none';
                 body.classList.add('loaded');
             }, 1000);
        }

        window.onload = function() {
            startCountdown();
            
            const video = document.getElementById('video-background');
            
            // 1. ตรวจสอบว่าวิดีโอโหลดพร้อมที่จะเล่นได้หรือไม่
            if (video.readyState >= 3) { 
                video.play();
                hideLoadingScreen();
            } else {
                // 2. ถ้าวิดีโอยังไม่พร้อม ให้รอ Event 'canplaythrough' 
                video.addEventListener('canplaythrough', function() {
                    video.play(); 
                    hideLoadingScreen(); 
                }, { once: true });
            }
        };

    </script>
</body>
</html>